<!DOCTYPE html>
<html lang="vi" itemscope itemtype="https://schema.org/Book">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Đọc Truyện: Ngạo Thế Cửu Trọng Thiên - Chương 1 | TruyệnStorm</title>
    <meta name="description"
        content="Đọc truyện Ngạo Thế Cửu Trọng Thiên - Chương 1: Khởi Đầu Mới online tại TruyệnStorm. Giao diện đọc tối ưu cho mobile và desktop.">
    <meta name="keywords" content="đọc truyện online, Ngạo Thế Cửu Trọng Thiên, chương 1, tiên hiệp">
    <meta name="author" content="TruyệnStorm">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://truyenstorm.com/truyen/ngao-the-cuu-trong-thien/chuong-1">

    <!-- Open Graph -->
    <meta property="og:type" content="article">
    <meta property="og:title" content="Ngạo Thế Cửu Trọng Thiên - Chương 1">
    <meta property="og:description"
        content="Đọc chương 1 của truyện Ngạo Thế Cửu Trọng Thiên với giao diện tối ưu, nhiều tùy chọn đọc.">
    <meta property="og:url" content="https://truyenstorm.com/truyen/ngao-the-cuu-trong-thien/chuong-1">
    <meta property="og:site_name" content="TruyệnStorm">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Ngạo Thế Cửu Trọng Thiên - Chương 1">
    <meta name="twitter:description"
        content="Đọc chương 1 của truyện Ngạo Thế Cửu Trọng Thiên với giao diện tối ưu, nhiều tùy chọn đọc.">

    <!-- Preload critical resources -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Styles -->
    <!-- NOTE: For production, replace CDN with a local build of Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#2563eb',
                        secondary: '#1f2937',
                        accent: '#f59e0b'
                    },
                    fontFamily: {
                        'sans': ['Inter', 'system-ui', 'sans-serif'],
                        'serif': ['Georgia', 'serif']
                    }
                }
            }
        }
    </script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="styles.css" rel="stylesheet">

    <style>
        /* Reading-specific styles */
        body {
            --reader-font-size: 17px;
            --reader-line-height: 1.95;
            --reader-letter-spacing: 0.01em;
            --reader-max-width: 68ch;
        }

        .reading-bg-light {
            background: #f8fafc;
            color: #1f2937;
        }

        .reading-bg-dark {
            background: #0f172a;
            color: #e2e8f0;
        }

        .reading-bg-sepia {
            background: #f4efe2;
            color: #5c4f3a;
        }

        .font-size-small {
            --reader-font-size: 15px;
            --reader-line-height: 1.85;
        }

        .font-size-medium {
            --reader-font-size: 17px;
            --reader-line-height: 1.95;
        }

        .font-size-large {
            --reader-font-size: 19px;
            --reader-line-height: 2;
        }

        .font-size-xlarge {
            --reader-font-size: 21px;
            --reader-line-height: 2.05;
        }

        .toolbar-hidden {
            transform: translateY(-110%);
            opacity: 0.96;
        }

        .toolbar-visible {
            transform: translateY(0);
            opacity: 1;
        }

        .reader-main {
            padding-top: 4.75rem;
            padding-bottom: 6.5rem;
        }

        .chapter-content {
            max-width: 960px;
            margin: 0 auto;
            padding: clamp(1rem, 3vw, 2rem) 1rem;
        }

        .chapter-text {
            max-width: var(--reader-max-width);
            margin: 0 auto;
            font-size: var(--reader-font-size);
            line-height: var(--reader-line-height);
            letter-spacing: var(--reader-letter-spacing);
            text-wrap: pretty;
            word-break: break-word;
        }

        .chapter-text p {
            margin: 0 0 1.1em;
            text-align: left;
        }

        .chapter-text p+p {
            text-indent: 1.4em;
        }

        .chapter-text p:last-child {
            margin-bottom: 0;
        }

        .chapter-sidebar {
            width: min(22rem, 92vw);
            transform: translateX(-100%);
            transition: transform 0.28s ease;
        }

        .chapter-sidebar.open {
            transform: translateX(0);
        }

        .settings-panel {
            width: min(22rem, 92vw);
        }

        .reading-progress-bar {
            height: 3px;
            background: linear-gradient(to right, #2563eb 0%, #2563eb var(--progress, 0%), #e5e7eb var(--progress, 0%), #e5e7eb 100%);
            transition: width 0.1s linear;
        }

        .bottom-nav {
            transition: transform 0.25s ease, opacity 0.25s ease;
            padding-bottom: max(env(safe-area-inset-bottom), 0px);
        }

        .bottom-nav-hidden {
            transform: translateY(110%);
            opacity: 0.96;
        }

        .reading-bg-dark #topToolbar,
        .reading-bg-dark #bottomNav,
        .reading-bg-dark #chapterSidebar,
        .reading-bg-dark #settingsPanel {
            background-color: #111827 !important;
            border-color: #374151 !important;
            color: #e5e7eb;
        }

        .reading-bg-dark #topToolbar .text-gray-800,
        .reading-bg-dark #chapterSidebar .text-gray-800,
        .reading-bg-dark #settingsPanel .text-gray-800 {
            color: #f3f4f6 !important;
        }

        .reading-bg-dark #topToolbar .text-gray-600,
        .reading-bg-dark #chapterSidebar .text-gray-600,
        .reading-bg-dark #settingsPanel .text-gray-600,
        .reading-bg-dark #bottomNav .text-gray-600,
        .reading-bg-dark #topToolbar .text-gray-500,
        .reading-bg-dark #chapterSidebar .text-gray-500,
        .reading-bg-dark #settingsPanel .text-gray-500,
        .reading-bg-dark #bottomNav .text-gray-500 {
            color: #9ca3af !important;
        }

        .reading-bg-dark #topToolbar .bg-gray-100,
        .reading-bg-dark #topToolbar .bg-blue-100,
        .reading-bg-dark #bottomNav .bg-gray-100,
        .reading-bg-dark #settingsPanel .bg-gray-100 {
            background-color: #1f2937 !important;
            color: #d1d5db !important;
        }

        .reading-bg-dark #topToolbar .hover\:bg-gray-100:hover,
        .reading-bg-dark #chapterSidebar .hover\:bg-gray-50:hover,
        .reading-bg-dark #settingsPanel .hover\:bg-gray-50:hover,
        .reading-bg-dark #settingsPanel .hover\:bg-gray-200:hover,
        .reading-bg-dark #bottomNav .hover\:bg-gray-100:hover,
        .reading-bg-dark #bottomNav .hover\:bg-gray-200:hover {
            background-color: #1f2937 !important;
        }

        .reading-bg-dark .chapter-title,
        .reading-bg-dark .chapter-subtitle {
            color: #f8fafc !important;
        }

        .reading-bg-dark .chapter-meta {
            color: #94a3b8 !important;
        }

        .reading-bg-dark .chapter-text {
            color: #e5e7eb;
        }

        .reading-bg-sepia #topToolbar,
        .reading-bg-sepia #bottomNav,
        .reading-bg-sepia #chapterSidebar,
        .reading-bg-sepia #settingsPanel {
            background-color: #f8f1e4 !important;
            border-color: #d9c7a0 !important;
            color: #5c4f3a;
        }

        .reading-bg-sepia #topToolbar .text-gray-800,
        .reading-bg-sepia #chapterSidebar .text-gray-800,
        .reading-bg-sepia #settingsPanel .text-gray-800 {
            color: #5c4f3a !important;
        }

        .reading-bg-sepia #topToolbar .text-gray-600,
        .reading-bg-sepia #chapterSidebar .text-gray-600,
        .reading-bg-sepia #settingsPanel .text-gray-600,
        .reading-bg-sepia #bottomNav .text-gray-600,
        .reading-bg-sepia #topToolbar .text-gray-500,
        .reading-bg-sepia #chapterSidebar .text-gray-500,
        .reading-bg-sepia #settingsPanel .text-gray-500 {
            color: #7c6a52 !important;
        }

        .reading-bg-sepia .chapter-title,
        .reading-bg-sepia .chapter-subtitle {
            color: #5c4f3a !important;
        }

        .reading-bg-sepia .chapter-meta {
            color: #7c6a52 !important;
        }

        @media (max-width: 640px) {
            .reader-main {
                padding-top: 4.45rem;
                padding-bottom: 5.7rem;
            }

            .chapter-content {
                padding: 1rem 0.85rem 1.25rem;
            }

            .chapter-text p+p {
                text-indent: 1em;
            }
        }
    </style>
</head>

<body class="reading-bg-light font-size-medium transition-all duration-300">
    <!-- Reading Progress Bar -->
    <div class="reading-progress-bar fixed top-0 left-0 w-full z-50" style="--progress: 0%"></div>

    <!-- Enhanced Top Toolbar -->
    <div class="fixed top-0 left-0 right-0 bg-white/95 backdrop-blur-sm border-b border-gray-200 shadow-lg z-40 toolbar-visible transition-all duration-300"
        id="topToolbar" role="toolbar" aria-label="Công cụ đọc">
        <div class="flex items-center justify-between px-4 py-3">
            <div class="flex items-center space-x-3">
                <a href="story-detail.html"
                    class="text-gray-600 hover:text-primary transition-all duration-300 p-2 rounded-full hover:bg-gray-100"
                    aria-label="Quay lại trang chi tiết">
                    <i class="fas fa-arrow-left text-lg" aria-hidden="true"></i>
                </a>
                <div>
                    <h1 class="font-semibold text-gray-800 text-sm">Ngạo Thế Cửu Trọng Thiên</h1>
                    <p class="text-xs text-gray-500">Chương 1: Khởi Đầu Mới</p>
                </div>
            </div>

            <!-- Enhanced Progress Info -->
            <div class="hidden sm:flex items-center space-x-4">
                <div class="text-xs text-gray-500 bg-gray-100 px-3 py-1 rounded-full">
                    <span id="progressText">0% hoàn thành</span>
                </div>
                <div class="text-xs text-gray-500 bg-blue-100 px-3 py-1 rounded-full flex items-center">
                    <i class="fas fa-eye mr-1" aria-hidden="true"></i>
                    <span class="view-count">1,248,539</span>
                </div>
            </div>

            <div class="flex items-center space-x-2">
                <button class="text-gray-600 hover:text-primary transition-colors p-2 rounded hover:bg-gray-100"
                    id="chapterListBtn" aria-label="Danh sách chương" aria-controls="chapterSidebar">
                    <i class="fas fa-list" aria-hidden="true"></i>
                </button>
                <button class="text-gray-600 hover:text-primary transition-colors p-2 rounded hover:bg-gray-100"
                    id="settingsBtn" aria-label="Cài đặt hiển thị" aria-controls="settingsPanel">
                    <i class="fas fa-cog" aria-hidden="true"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Chapter Sidebar -->
    <div class="fixed left-0 top-0 h-full w-80 bg-white shadow-xl z-50 chapter-sidebar" id="chapterSidebar"
        role="dialog" aria-label="Danh sách chương" aria-modal="true" aria-hidden="true">
        <div class="flex items-center justify-between p-4 border-b border-gray-200">
            <h2 class="font-semibold text-gray-800">Danh sách chương</h2>
            <button class="text-gray-600 hover:text-primary transition-colors p-2 rounded hover:bg-gray-100"
                id="closeSidebar" aria-label="Đóng danh sách chương">
                <i class="fas fa-times" aria-hidden="true"></i>
            </button>
        </div>
        <div class="overflow-y-auto h-full pb-20">
            <div class="p-4">
                <div class="space-y-2">
                    <a href="#"
                        class="block p-3 rounded-lg hover:bg-gray-50 transition-colors bg-blue-50 border-l-4 border-primary">
                        <div class="font-medium text-gray-800">Chương 1</div>
                        <div class="text-sm text-gray-500">Khởi Đầu Mới</div>
                    </a>
                    <a href="#" class="block p-3 rounded-lg hover:bg-gray-50 transition-colors">
                        <div class="font-medium text-gray-800">Chương 2</div>
                        <div class="text-sm text-gray-500">Ký Ức Tiền Kiếp</div>
                    </a>
                    <a href="#" class="block p-3 rounded-lg hover:bg-gray-50 transition-colors">
                        <div class="font-medium text-gray-800">Chương 3</div>
                        <div class="text-sm text-gray-500">Cửu Kiếp Kiếm</div>
                    </a>
                    <a href="#" class="block p-3 rounded-lg hover:bg-gray-50 transition-colors">
                        <div class="font-medium text-gray-800">Chương 4</div>
                        <div class="text-sm text-gray-500">Tu Luyện Bắt Đầu</div>
                    </a>
                    <a href="#" class="block p-3 rounded-lg hover:bg-gray-50 transition-colors">
                        <div class="font-medium text-gray-800">Chương 5</div>
                        <div class="text-sm text-gray-500">Đối Đầu Đầu Tiên</div>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Panel -->
    <div class="fixed right-0 top-0 h-full w-80 bg-white shadow-xl z-50 transform translate-x-full transition-transform duration-300 settings-panel"
        id="settingsPanel" role="dialog" aria-label="Cài đặt đọc truyện" aria-modal="true" aria-hidden="true">
        <div class="flex items-center justify-between p-4 border-b border-gray-200">
            <h2 class="font-semibold text-gray-800">Cài đặt đọc truyện</h2>
            <button class="text-gray-600 hover:text-primary transition-colors p-2 rounded hover:bg-gray-100"
                id="closeSettings" aria-label="Đóng cài đặt">
                <i class="fas fa-times" aria-hidden="true"></i>
            </button>
        </div>
        <div class="p-4 space-y-6">
            <!-- Theme Settings -->
            <div>
                <h3 class="font-medium text-gray-800 mb-3">Giao diện</h3>
                <div class="grid grid-cols-3 gap-2" role="radiogroup" aria-label="Chọn giao diện">
                    <button
                        class="theme-btn p-3 rounded-lg border-2 border-primary bg-white text-gray-800 text-sm flex flex-col items-center justify-center hover:bg-gray-50 transition-colors"
                        data-theme="light" role="radio" aria-checked="true">
                        <i class="fas fa-sun mb-1" aria-hidden="true"></i>Sáng
                    </button>
                    <button
                        class="theme-btn p-3 rounded-lg border-2 border-gray-200 bg-gray-800 text-white text-sm flex flex-col items-center justify-center hover:opacity-90 transition-opacity"
                        data-theme="dark" role="radio" aria-checked="false">
                        <i class="fas fa-moon mb-1" aria-hidden="true"></i>Tối
                    </button>
                    <button
                        class="theme-btn p-3 rounded-lg border-2 border-gray-200 bg-[#f4f1e8] text-[#5c4f3a] text-sm flex flex-col items-center justify-center hover:opacity-90 transition-opacity"
                        data-theme="sepia" role="radio" aria-checked="false">
                        <i class="fas fa-coffee mb-1" aria-hidden="true"></i>Sepia
                    </button>
                </div>
            </div>

            <!-- Font Size -->
            <div>
                <h3 class="font-medium text-gray-800 mb-3">Cỡ chữ</h3>
                <div class="flex items-center space-x-2" role="radiogroup" aria-label="Chọn cỡ chữ">
                    <button
                        class="flex-1 p-2 text-sm border border-gray-200 rounded hover:bg-gray-50 transition-colors font-size-btn"
                        data-size="small" role="radio" aria-checked="false">Nhỏ</button>
                    <button
                        class="flex-1 p-2 text-sm border-2 border-primary text-primary rounded font-size-btn font-semibold"
                        data-size="medium" role="radio" aria-checked="true">Vừa</button>
                    <button
                        class="flex-1 p-2 text-sm border border-gray-200 rounded hover:bg-gray-50 transition-colors font-size-btn"
                        data-size="large" role="radio" aria-checked="false">Lớn</button>
                    <button
                        class="flex-1 p-2 text-sm border border-gray-200 rounded hover:bg-gray-50 transition-colors font-size-btn"
                        data-size="xlarge" role="radio" aria-checked="false">Rất lớn</button>
                </div>
            </div>

            <!-- Auto Scroll -->
            <div>
                <h3 class="font-medium text-gray-800 mb-3">Tự động cuộn</h3>
                <div class="flex items-center justify-between">
                    <span class="text-sm text-gray-600" id="auto-scroll-label">Bật tự động cuộn</span>
                    <label class="relative inline-flex items-center cursor-pointer">
                        <input type="checkbox" class="sr-only peer" id="autoScrollToggle"
                            aria-labelledby="auto-scroll-label">
                        <div
                            class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary">
                        </div>
                    </label>
                </div>
                <div class="mt-3">
                    <label for="scrollSpeed" class="text-sm text-gray-600 block mb-1">Tốc độ cuộn</label>
                    <input type="range" min="1" max="10" value="3"
                        class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer" id="scrollSpeed">
                </div>
            </div>

            <!-- Quick Actions -->
            <div>
                <h3 class="font-medium text-gray-800 mb-3">Thao tác nhanh</h3>
                <div class="space-y-2">
                    <button
                        class="w-full p-2 text-left text-sm bg-gray-100 rounded hover:bg-gray-200 transition-colors flex items-center">
                        <i class="fas fa-bookmark mr-2 text-gray-500" aria-hidden="true"></i>Đánh dấu trang
                    </button>
                    <button
                        class="w-full p-2 text-left text-sm bg-gray-100 rounded hover:bg-gray-200 transition-colors flex items-center">
                        <i class="fas fa-share mr-2 text-gray-500" aria-hidden="true"></i>Chia sẻ chương
                    </button>
                    <button
                        class="w-full p-2 text-left text-sm bg-gray-100 rounded hover:bg-gray-200 transition-colors flex items-center">
                        <i class="fas fa-bug mr-2 text-gray-500" aria-hidden="true"></i>Báo lỗi
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="reader-main" role="main">
        <div class="chapter-content">
            <article class="prose max-w-none story-content">
                <header class="text-center mb-8">
                    <h1 class="chapter-title text-2xl font-bold text-gray-800 mb-2">Chương 1: Khởi Đầu Mới</h1>
                    <p class="chapter-subtitle text-gray-600">Ngạo Thế Cửu Trọng Thiên</p>
                    <div class="chapter-meta mt-4 text-sm text-gray-500 flex items-center justify-center space-x-3">
                        <span><i class="far fa-clock mr-1" aria-hidden="true"></i>Cập nhật: 2 ngày trước</span>
                        <span>•</span>
                        <span><i class="fas fa-file-alt mr-1" aria-hidden="true"></i>2,847 từ</span>
                    </div>
                </header>

                <div class="chapter-text">
                    <p>
                        Gió thu se lạnh thổi qua, lá vàng rơi rụng khắp sân. Chu Dương ngồi một mình trong góc vườn,
                        ánh mắt trống rỗng nhìn về phía xa. Hôm nay là ngày sinh nhật lần thứ mười sáu của cậu,
                        nhưng không một ai nhớ đến.
                    </p>

                    <p>
                        "Phế vật! Ngươi còn ngồi đây làm gì? Không thấy mọi người đang chuẩn bị cho đại lễ của
                        thiếu gia Chu Hằng sao?" Một giọng nói chế nhạo vang lên phía sau.
                    </p>

                    <p>
                        Chu Dương không quay lại. Cậu biết đó là Chu Minh, một trong những đệ tử xuất sắc nhất
                        của gia tộc Chu. Từ nhỏ, Chu Minh đã luôn coi thường Chu Dương vì cậu không thể tu luyện.
                    </p>

                    <p>
                        "Tôi chỉ ngồi đây một chút thôi." Chu Dương nói nhỏ, giọng nói không có chút cảm xúc nào.
                    </p>

                    <p>
                        "Hừ! Ngươi biết tự biết tướng là tốt. Một kẻ không thể tu luyện như ngươi, ở đây chỉ là
                        làm mất mặt gia tộc mà thôi. Nếu tôi là ngươi, tôi đã tự sát từ lâu rồi!"
                    </p>

                    <p>
                        Những lời cay nghiệt ấy như những mũi dao đâm vào tim Chu Dương. Nhưng cậu đã quen rồi.
                        Suốt mười sáu năm qua, cậu đã nghe những lời tương tự không biết bao nhiêu lần.
                    </p>

                    <p>
                        Chu Minh thấy Chu Dương không phản ứng liền cảm thấy chán nản, quay lưng bỏ đi. Nhưng
                        trước khi đi, hắn không quên nói thêm: "Nghe nói cha ngươi đang tìm cách đuổi ngươi khỏi
                        gia tộc. Cũng đúng thôi, nuôi một kẻ vô dụng như ngươi làm gì!"
                    </p>

                    <p>
                        Tiếng bước chân của Chu Minh dần xa dần, nhưng những lời hắn nói vẫn vang vọng trong
                        tai Chu Dương. Cha muốn đuổi mình khỏi gia tộc? Chu Dương cười cay đắng. Có lẽ đó
                        cũng là điều tốt nhất cho tất cả mọi người.
                    </p>

                    <p>
                        Đúng lúc đó, một làn gió lạnh thổi qua, mang theo một mảnh giấy bay đến trước mặt Chu Dương.
                        Cậu vô thức đưa tay bắt lấy, nhìn thấy đó là một tờ giấy cũ với những dòng chữ mờ nhạt.
                    </p>

                    <p>
                        "Cửu Kiếp Kiếm... người được chọn..." Chu Dương đọc thầm những dòng chữ trên giấy.
                        Đột nhiên, một luồng ký ức lạ lùng ùa về trong đầu cậu. Những hình ảnh không thuộc về
                        cuộc đời này, những ký ức của một người khác...
                    </p>

                    <p>
                        "Không thể nào..." Chu Dương thở gấp, ánh mắt mở to. Cậu nhớ ra rồi! Đây không phải
                        là lần đầu tiên cậu sống! Trong kiếp trước, cậu chính là Chu Dương, nhưng đã trở thành
                        một trong những thiên đế mạnh nhất trong cửu trùng thiên!
                    </p>

                    <p>
                        Tất cả mọi thứ đều trở lại! Ký ức về những năm tháng tu luyện khổ cực, về những trận
                        chiến sinh tử, về ngày cậu bị phản bội và chết trong tay kẻ thù... Và giờ đây, cậu đã
                        được cơ hội quay trở lại!
                    </p>

                    <p>
                        "Lần này, ta sẽ không để những bi kịch ấy lặp lại!" Chu Dương nắm chặt tờ giấy trong tay,
                        ánh mắt bừng sáng lên một ngọn lửa quyết tâm. "Ta sẽ trở thành mạnh nhất, và khiến tất cả
                        những kẻ từng coi thường ta phải hối hận!"
                    </p>

                    <p>
                        Gió thu vẫn thổi, nhưng Chu Dương không còn cảm thấy lạnh nữa. Trong lòng cậu, ngọn lửa
                        của hy vọng và quyết tâm đã được thắp sáng. Hành trình mới sắp bắt đầu!
                    </p>
                </div>
            </article>
        </div>
    </main>

    <!-- Bottom Navigation -->
    <div class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-lg z-40 bottom-nav"
        id="bottomNav">
        <div class="flex items-center justify-between px-4 py-3 max-w-4xl mx-auto">
            <a href="reader.html?chapter=0" id="prevChapterBtn"
                class="flex items-center space-x-2 px-4 py-2 bg-gray-100 text-gray-600 rounded-lg hover:bg-gray-200 transition-colors">
                <i class="fas fa-chevron-left" aria-hidden="true"></i>
                <span class="text-sm font-medium">Chương trước</span>
            </a>

            <div class="flex items-center space-x-3">
                <button class="p-2 text-gray-600 hover:text-primary transition-colors rounded hover:bg-gray-100"
                    id="bookmarkBtn" aria-label="Đánh dấu">
                    <i class="fas fa-bookmark" aria-hidden="true"></i>
                </button>
                <button class="p-2 text-gray-600 hover:text-primary transition-colors rounded hover:bg-gray-100"
                    id="shareBtn" aria-label="Chia sẻ">
                    <i class="fas fa-share" aria-hidden="true"></i>
                </button>
                <button class="p-2 text-gray-600 hover:text-primary transition-colors rounded hover:bg-gray-100"
                    id="commentBtn" aria-label="Bình luận">
                    <i class="fas fa-comment" aria-hidden="true"></i>
                </button>
            </div>

            <a href="reader.html?chapter=2" id="nextChapterBtn"
                class="flex items-center space-x-2 px-4 py-2 bg-primary text-white rounded-lg hover:bg-blue-700 transition-colors shadow-md">
                <span class="text-sm font-medium">Chương tiếp</span>
                <i class="fas fa-chevron-right" aria-hidden="true"></i>
            </a>
        </div>
    </div>

    <!-- Overlay -->
    <div class="fixed inset-0 bg-black bg-opacity-50 z-30 hidden" id="overlay" aria-hidden="true"></div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const body = document.body;
            const themeBtns = Array.from(document.querySelectorAll('.theme-btn'));
            const fontSizeBtns = Array.from(document.querySelectorAll('.font-size-btn'));

            const chapterListBtn = document.getElementById('chapterListBtn');
            const settingsBtn = document.getElementById('settingsBtn');
            const chapterSidebar = document.getElementById('chapterSidebar');
            const settingsPanel = document.getElementById('settingsPanel');
            const overlay = document.getElementById('overlay');
            const closeSidebarBtn = document.getElementById('closeSidebar');
            const closeSettingsBtn = document.getElementById('closeSettings');
            const topToolbar = document.getElementById('topToolbar');
            const bottomNav = document.getElementById('bottomNav');
            const progressBar = document.querySelector('.reading-progress-bar');
            const progressText = document.getElementById('progressText');
            const prevChapterBtn = document.getElementById('prevChapterBtn');
            const nextChapterBtn = document.getElementById('nextChapterBtn');
            const autoScrollToggle = document.getElementById('autoScrollToggle');
            const scrollSpeed = document.getElementById('scrollSpeed');

            let autoScrollInterval = null;
            let lastScrollTop = window.scrollY || window.pageYOffset;
            let ticking = false;

            function setTheme(theme) {
                const allowedTheme = ['light', 'dark', 'sepia'].includes(theme) ? theme : 'light';
                body.classList.remove('reading-bg-light', 'reading-bg-dark', 'reading-bg-sepia');
                body.classList.add(`reading-bg-${allowedTheme}`);

                themeBtns.forEach((btn) => {
                    const isActive = btn.dataset.theme === allowedTheme;
                    btn.classList.toggle('border-primary', isActive);
                    btn.classList.toggle('border-gray-200', !isActive);
                    btn.setAttribute('aria-checked', String(isActive));
                });

                localStorage.setItem('reading-theme', allowedTheme);
            }

            function setFontSize(size) {
                const allowedSize = ['small', 'medium', 'large', 'xlarge'].includes(size) ? size : 'medium';
                body.classList.remove('font-size-small', 'font-size-medium', 'font-size-large', 'font-size-xlarge');
                body.classList.add(`font-size-${allowedSize}`);

                fontSizeBtns.forEach((btn) => {
                    const isActive = btn.dataset.size === allowedSize;
                    btn.classList.toggle('border-primary', isActive);
                    btn.classList.toggle('text-primary', isActive);
                    btn.classList.toggle('border-2', isActive);
                    btn.classList.toggle('font-semibold', isActive);
                    btn.classList.toggle('border-gray-200', !isActive);
                    btn.setAttribute('aria-checked', String(isActive));
                });

                localStorage.setItem('font-size', allowedSize);
            }

            function syncOverlayState() {
                const isSidebarOpen = chapterSidebar.classList.contains('open');
                const isSettingsOpen = !settingsPanel.classList.contains('translate-x-full');
                const hasPanelOpen = isSidebarOpen || isSettingsOpen;

                overlay.classList.toggle('hidden', !hasPanelOpen);
                body.style.overflow = hasPanelOpen ? 'hidden' : '';

                if (hasPanelOpen && topToolbar && bottomNav) {
                    topToolbar.classList.remove('toolbar-hidden');
                    topToolbar.classList.add('toolbar-visible');
                    bottomNav.classList.remove('bottom-nav-hidden');
                }
            }

            function openSidebar() {
                chapterSidebar.classList.add('open');
                chapterSidebar.setAttribute('aria-hidden', 'false');
                syncOverlayState();
            }

            function closeSidebar() {
                chapterSidebar.classList.remove('open');
                chapterSidebar.setAttribute('aria-hidden', 'true');
                syncOverlayState();
            }

            function openSettings() {
                settingsPanel.classList.remove('translate-x-full');
                settingsPanel.setAttribute('aria-hidden', 'false');
                syncOverlayState();
            }

            function closeSettings() {
                settingsPanel.classList.add('translate-x-full');
                settingsPanel.setAttribute('aria-hidden', 'true');
                syncOverlayState();
            }

            function stopAutoScroll() {
                if (autoScrollInterval) {
                    clearInterval(autoScrollInterval);
                    autoScrollInterval = null;
                }
            }

            function startAutoScroll() {
                const speed = parseInt(scrollSpeed.value, 10) || 3;
                const interval = Math.max(12, 52 - (speed * 4));
                const step = Math.max(1, Math.round(speed / 2));

                stopAutoScroll();
                autoScrollInterval = setInterval(() => {
                    window.scrollBy({ top: step, behavior: 'auto' });

                    if ((window.innerHeight + window.scrollY) >= (document.documentElement.scrollHeight - 2)) {
                        stopAutoScroll();
                        autoScrollToggle.checked = false;
                    }
                }, interval);
            }

            function updateProgress() {
                const winHeight = window.innerHeight;
                const docHeight = document.documentElement.scrollHeight - winHeight;
                const scrollTop = window.scrollY || window.pageYOffset;
                const progress = docHeight <= 0
                    ? 100
                    : Math.min(100, Math.max(0, (scrollTop / docHeight) * 100));

                if (progressBar) {
                    progressBar.style.setProperty('--progress', `${progress}%`);
                }

                if (progressText) {
                    progressText.textContent = `${Math.round(progress)}% hoàn thành`;
                }
            }

            function updateChromeVisibility() {
                if (!topToolbar || !bottomNav) {
                    return;
                }

                const currentScrollTop = window.scrollY || window.pageYOffset;
                const scrollDelta = currentScrollTop - lastScrollTop;
                const hasPanelOpen = !overlay.classList.contains('hidden');
                const shouldHide = !hasPanelOpen && currentScrollTop > 120 && scrollDelta > 8;
                const shouldShow = hasPanelOpen || currentScrollTop < 80 || scrollDelta < -8;

                if (shouldHide) {
                    topToolbar.classList.remove('toolbar-visible');
                    topToolbar.classList.add('toolbar-hidden');
                    bottomNav.classList.add('bottom-nav-hidden');
                } else if (shouldShow) {
                    topToolbar.classList.remove('toolbar-hidden');
                    topToolbar.classList.add('toolbar-visible');
                    bottomNav.classList.remove('bottom-nav-hidden');
                }

                lastScrollTop = currentScrollTop;
            }

            function onScroll() {
                if (ticking) {
                    return;
                }

                ticking = true;
                requestAnimationFrame(() => {
                    updateProgress();
                    updateChromeVisibility();
                    ticking = false;
                });
            }

            themeBtns.forEach((btn) => {
                btn.addEventListener('click', () => {
                    setTheme(btn.dataset.theme || 'light');
                });
            });

            fontSizeBtns.forEach((btn) => {
                btn.addEventListener('click', () => {
                    setFontSize(btn.dataset.size || 'medium');
                });
            });

            chapterListBtn.addEventListener('click', openSidebar);
            settingsBtn.addEventListener('click', openSettings);
            closeSidebarBtn.addEventListener('click', closeSidebar);
            closeSettingsBtn.addEventListener('click', closeSettings);

            overlay.addEventListener('click', () => {
                closeSidebar();
                closeSettings();
            });

            autoScrollToggle.addEventListener('change', () => {
                if (autoScrollToggle.checked) {
                    startAutoScroll();
                } else {
                    stopAutoScroll();
                }
            });

            scrollSpeed.addEventListener('input', () => {
                if (autoScrollToggle.checked) {
                    startAutoScroll();
                }
            });

            window.addEventListener('scroll', onScroll, { passive: true });
            window.addEventListener('resize', updateProgress);

            document.addEventListener('keydown', (event) => {
                const isTyping = event.target.tagName === 'INPUT'
                    || event.target.tagName === 'TEXTAREA'
                    || event.target.tagName === 'SELECT';
                const hasPanelOpen = !overlay.classList.contains('hidden');

                switch (event.key) {
                    case 'ArrowLeft':
                        if (!isTyping && !hasPanelOpen && prevChapterBtn) {
                            event.preventDefault();
                            window.location.href = prevChapterBtn.href;
                        }
                        break;
                    case 'ArrowRight':
                        if (!isTyping && !hasPanelOpen && nextChapterBtn) {
                            event.preventDefault();
                            window.location.href = nextChapterBtn.href;
                        }
                        break;
                    case ' ':
                        if (!isTyping) {
                            event.preventDefault();
                            autoScrollToggle.checked = !autoScrollToggle.checked;
                            autoScrollToggle.dispatchEvent(new Event('change'));
                        }
                        break;
                    case 'Escape':
                        closeSidebar();
                        closeSettings();
                        break;
                }
            });

            setTheme(localStorage.getItem('reading-theme') || 'light');
            setFontSize(localStorage.getItem('font-size') || 'medium');
            updateProgress();
            updateChromeVisibility();
        });
    </script>
    <script src="enhanced-script.js"></script>
    <script src="advanced-features.js"></script>
</body>

</html>
